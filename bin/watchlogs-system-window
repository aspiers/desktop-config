#!/bin/bash

. $ZDOTDIR/lib/libdpy.sh

font=smoothansi

eval $( get-font-geometry $font )

# Take 20% of height:
watchlogs_height_px=$(( dpy_height / 5 ))
watchlogs_height=$(( watchlogs_height_px / font_char_height ))

# Maybe allow some space on the right for gkrellm
right_margin=0
#right_margin=90
watchlogs_width_px=$(( dpy_width - right_margin ))
watchlogs_width=$(( watchlogs_width_px / font_char_width ))

if [[ "$DESKTOP_SESSION" == *gnome* ]] &&
   pgrep -u $UID gnome-panel >/dev/null
then
    if [ "`gconftool-2 \
             -g /apps/panel/toplevels/bottom_panel_screen0/auto_hide`" \
         == 'false' ]
    then
        bottom_margin=26
    else
        bottom_margin=7
    fi
else
    # FIXME: kde
    bottom_margin=0
fi

# Old style fake transparency: -tr -tint white -sh 70
#
# New style is full alpha transparency but needs composite extension
# and a compositing manager such as xcompmgr running.
#
# -is high-intensity styles for bold/blink
# +sk don't scroll to bottom on keypress (irrelevant with -bl ?)
# +sw don't scroll as new lines appear
# +sb turn off scrollbar
# -b 0 reduces border
# -bl totally removes border but stops window from ever gaining focus;
#     it also puts it above everything else for some reason
#      -name XTerm \
urxvt -fn $font -fb $font -is \
      +sk +sw +sb \
      -b 0 \
      -depth 32 -bg rgba:0000/0000/0000/4444 \
      -g ${watchlogs_width}x${watchlogs_height}+0-${bottom_margin} \
      -e watchlogs-system

#rxvt -fn $font +sk +sw -tr -g ${watchlogs_width}x${watchlogs_height}+0-0 \
#     -e watchlogs-system

#aterm -fn $font -fb $font -tr -g ${watchlogs_width}x${watchlogs_height}+0-0 \
#      -e watchlogs-system

#Eterm -t watchlogs-system -g ${watchlogs_width}x${watchlogs_height}+0-0
